<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>IPW Estimator of the Causal Effects of Additive Modified Treatment Policies — ipw_shift • haldensify</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="IPW Estimator of the Causal Effects of Additive Modified Treatment Policies — ipw_shift"><meta name="description" content="IPW Estimator of the Causal Effects of Additive Modified Treatment Policies"><meta property="og:description" content="IPW Estimator of the Causal Effects of Additive Modified Treatment Policies"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">haldensify</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/intro_haldensify.html">Highly Adaptive Lasso Conditional Density Estimation</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nhejazi/haldensify/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>IPW Estimator of the Causal Effects of Additive Modified Treatment Policies</h1>
      <small class="dont-index">Source: <a href="https://github.com/nhejazi/haldensify/blob/HEAD/R/ipw_shift.R" class="external-link"><code>R/ipw_shift.R</code></a></small>
      <div class="d-none name"><code>ipw_shift.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>IPW Estimator of the Causal Effects of Additive Modified Treatment Policies</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ipw_shift</span><span class="op">(</span></span>
<span>  <span class="va">W</span>,</span>
<span>  <span class="va">A</span>,</span>
<span>  <span class="va">Y</span>,</span>
<span>  delta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n_bins <span class="op">=</span> <span class="fu"><a href="make_bins.html">make_bins</a></span><span class="op">(</span><span class="va">A</span>, <span class="st">"hist"</span><span class="op">)</span>,</span>
<span>  cv_folds <span class="op">=</span> <span class="fl">10L</span>,</span>
<span>  <span class="va">lambda_seq</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  bin_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"equal_range"</span>, <span class="st">"equal_mass"</span><span class="op">)</span>,</span>
<span>  selector_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dcar"</span>, <span class="st">"plateau"</span>, <span class="st">"gcv"</span>, <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-w">W<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>A <code>matrix</code>, <code>data.frame</code>, or similar containing a set of
baseline covariates.</p></dd>


<dt id="arg-a">A<a class="anchor" aria-label="anchor" href="#arg-a"></a></dt>
<dd><p>A <code>numeric</code> vector corresponding to a exposure variable. The
parameter of interest is defined as a location shift of this quantity.</p></dd>


<dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A <code>numeric</code> vector of the observed outcomes.</p></dd>


<dt id="arg-delta">delta<a class="anchor" aria-label="anchor" href="#arg-delta"></a></dt>
<dd><p>A <code>numeric</code> value indicating the shift in the exposure to
be used in defining the target parameter. This is defined with respect to
the scale of the exposure (A).</p></dd>


<dt id="arg-n-bins">n_bins<a class="anchor" aria-label="anchor" href="#arg-n-bins"></a></dt>
<dd><p>A <code>numeric</code>, scalar or vector, indicating the number of
bins into which the support of A is to be partitioned for constructing
conditional density estimates.</p></dd>


<dt id="arg-cv-folds">cv_folds<a class="anchor" aria-label="anchor" href="#arg-cv-folds"></a></dt>
<dd><p>A <code>numeric</code> giving the number of folds to be used for
cross-validation. Note that this form of sample splitting is used for the
selection of tuning parameters by empirical risk minimization, not for the
estimation of nuisance parameters (i.e., to relax regularity conditions).</p></dd>


<dt id="arg-lambda-seq">lambda_seq<a class="anchor" aria-label="anchor" href="#arg-lambda-seq"></a></dt>
<dd><p>A <code>numeric</code> sequence of the regularization parameter
(L1 norm of HAL coefficients) to be used in fitting HAL models.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments for model fitting to be passed directly to
<code><a href="haldensify.html">haldensify</a></code>.</p></dd>


<dt id="arg-bin-type">bin_type<a class="anchor" aria-label="anchor" href="#arg-bin-type"></a></dt>
<dd><p>A <code>character</code> indicating the strategy to be used in
creating bins along the observed support of <code>A</code>. For bins of equal
range, use <code>"equal_range"</code>; to ensure each bin has the same number of
observations, use instead <code>"equal_mass"</code>. For more information, see
documentation of <code>grid_type</code> in <code><a href="haldensify.html">haldensify</a></code>.</p></dd>


<dt id="arg-selector-type">selector_type<a class="anchor" aria-label="anchor" href="#arg-selector-type"></a></dt>
<dd><p>A <code>character</code> indicating the selection strategy
for identifying an efficent IPW estimator. The choices include <code>"gcv"</code>
for global cross-validation, <code>"dcar"</code> for solving the EIF equation,
and <code>"plateau"</code> for agnostic approaches (1) balancing changes in the
IPW estimate and its standard error (adapting Lepski's method) and (2) a
plateau detector for inflection points in the IPW estimator's trajectory.
The option <code>"all"</code> runs all three selection strategies while sharing
redundant computation between each.</p></dd>

</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># simulate data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">11249</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="va">W1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">W2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">W3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">3</span> <span class="op">*</span> <span class="va">W1</span> <span class="op">-</span> <span class="va">W2</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">W1</span> <span class="op">*</span> <span class="va">W2</span> <span class="op">+</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n_obs</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">A</span> <span class="op">+</span> <span class="va">W1</span> <span class="op">+</span> <span class="va">W2</span> <span class="op">-</span> <span class="va">W3</span> <span class="op">-</span> <span class="va">W1</span> <span class="op">*</span> <span class="va">W3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># fit the IPW estimator</span></span></span>
<span class="r-in"><span><span class="va">est_ipw</span> <span class="op">&lt;-</span> <span class="fu">ipw_shift</span><span class="op">(</span></span></span>
<span class="r-in"><span>  W <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">W1</span>, <span class="va">W2</span>, <span class="va">W3</span><span class="op">)</span>, A <span class="op">=</span> <span class="va">A</span>, Y <span class="op">=</span> <span class="va">Y</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="fl">0.5</span>, cv_folds <span class="op">=</span> <span class="fl">3L</span>,</span></span>
<span class="r-in"><span>  n_bins <span class="op">=</span> <span class="fl">4L</span>, bin_type <span class="op">=</span> <span class="st">"equal_range"</span>,</span></span>
<span class="r-in"><span>  lambda_seq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">10</span>, length <span class="op">=</span> <span class="fl">100L</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="co"># arguments passed to hal9001::fit_hal()</span></span></span>
<span class="r-in"><span>  max_degree <span class="op">=</span> <span class="fl">1L</span>,</span></span>
<span class="r-in"><span>  smoothness_orders <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  reduce_basis <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 8% of observations outside training support...predictions trimmed.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nima Hejazi, David Benkeser, Mark van der Laan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

